i:{(.'x@p),'(+\-/2#u)p:&~|/u:"[],"=\:x}'0:"i/18"
a:{$[^j:*|S:*'&|9 4<+x;x
 *S;?[x;j,j+1;(+\-2 2!'*x@j),'1+*|x@j]
 -1_1_@[?[0,x,0;1+j,j+2;,0 4];j,j+2;+;(*'x@j,j+1),'0]]}/+0 1++,
m:{$[^p:*&1_=':*|+x;**x;m?[x;p,p+2;,(+/3 2**'x@p,p+1;*|x[p]-1)]]}
m@a/i
|/m'a/'i(~=/')#+!2##i
