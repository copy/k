i:"#.<>^v"?0:"i/23"
step:{
 n:(0 1;0 -1;1 0;-1 0)+\:y
 n:n@&(~x./:n)&~(~k)|2 3 4 5=k:0|i./:n
 +(.[x;;:;1]'n;n)}
go:{
 p:+&i&^0 1 2?+/(|'(:)':'|'i;(:)':'i;(:)':i;|(:)':|i)
 m::p{
  q:((^y?*|:)(*step.)/)'step[.[^i;x;:;1]]x
  +(-1++//'q[;0];y?q[;1])}\:p
 {e:m[y]
  u:e@&~x@e[;1]
  0|/u[;0]+o[@[x;y;:;1]]'u[;1]}[{0}'p;0]}
go[]
i&:1
go[]
