i:i@<*'|'i:(.","/"~"\)'0:"i/22"
s:{
 q:{.[x;c-0 0,z[2]&~|//~^x.0 0 -1+c:z[!3]+!1+-/|0 3_z;:;y]}/[(1+3_|/x)#0N;!#x;x]
 (!#x)=(q.)'3_'x}
r:(+/s r_)'!#r:{x-'0 0 1 0 0 1*/:~s x}/i
+/r=-1+#r
+/-1-r-#r
