i:{{(*x;`$1_x),,`$'", "\y}." -> "\x}'0:"i/20"
i:{(*x;x@1;i[;1]?x@2;$["&"=*x;(&~^i[;2]?'x@1)!0;0])}'i
q:b,'i[b:i[;1]?`roadcaster;2],'0
f:{(i;p):+{#*|x}{
 (i;q):x
 (f;t;v):*q
 q:1_q
 $[^t;:(i;q);]
 m:i@t
 $[v&"%"=*m;:(i;q);]
 $["%"=*m;:(i;q,t,'m[2],'i[t;3]:~m@3);]
 i[t;3;f]:v
 (i;q,t,'m[2],'~&/i[t;3])}\x
 (*|i;(,0 0 0),-1_*'p)}
*/+/'~:\*'|',/*'|'(i;0){f(*x;y)}\1000#,q
*/{-/|&s~\:*|s:*{^(-1_*x)?*|*x}{(x[0],,*'|'i;i:*f(*|x;,y))}[;x]/(();i)}'q
