i:0:"i/21"
n:1+-2!26501365
b:(^i;"S"=i)
r:~(2(+,/3#,:)/"#"=i).M:2#,&&-2 4+2##i
sh:{(:':x)|(| :':|x)|(+ :':+x)|+| :':|+x}
s:2{0 2 1@x|r*2*sh 1=x}/
t:(,9#0)!0
h:*{((--/2#i)!n-#x)|3>#i:&(!*|x)~/:!'x:*x}{
 r:3(3{
   $[~^r:t@c:,/x;:r;]
   s:-2_'-2_2_'2_s(,/',/+'b@+x).M
   :t[c]:$[^n:b?s;-1+#b,:,s;n]}':+:)':(4*1+|//*'4(|+:)/u)(|+0,)/u:x 1
 (x[0],#'=,/r;r)}/(0#0!0;,,1)
+//1=b@!h 31
f:-/2#i:&(!*|h)~/:!'h
k:2+f!n-#h
r:{x[0]+(x[1]*k)+x[2]*-2!k*k-1}'{(x;y-x;z+x-y+y)}.','/h@/:i
+/(.r)*(+//2=b@)'!r
