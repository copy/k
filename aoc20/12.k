i:{(*x),.1_x}'0:"i/12"
abs:{(x;-x)x<0}
angle:{(4!)![-90;](*|x)*+/-1 1*"LR"=*x}
+/abs'+/i{(*|x)*(0 -1;1 0;-1 0;0 1)"NEWS"?$["F"~*x;y;*x]}'"ESWN"(4!)0+\angle'i
+/abs'2_(10 -1 0 0){
 p:2#x
 r:$[~^"LR"?*y;(-p-(angle y){(-*|x),*x}/p),0 0;0 0 0 0]
 r+x+(*|y)*(0 -1 0 0;1 0 0 0;-1 0 0 0;0 1 0 0;0 0,2#x)"NEWSF"?*y}/i
