i:"\n"\'"\n\n"\1:"i/13"
f:{
 c:x[e:","=*x]
 d:e+1
 $[(^c)|c="]";:(();d);]
 (r;l):f[(&/(x[e,d]>","),x[e,d]<"[")_d_x]
 $[&/(x[e,d]>","),x[e,d]<"["; :((.x@e,d),r; 1+l+d);]
 $[c<"["; :((.c),r; l+d);]
 (r2;l2):f[l_d_x]
 ((,r),r2;d+l+l2)}
i:{*f x}@''i
c:{
 t:`i=@'(x;y)
 $[&/t; :-1|1&x-y;]
 $[|/l:~#'(y;x); :-/l;]
 $[i:c[*x;*y];i;c[1_t[0],:/x;1_t[1],:/y]]}

+/(1+!#i)*0>c.'i
s:(,,,2;,,,6)
*/1+&|/s~/:\:i@<+/i c\:/:i:s,/i
