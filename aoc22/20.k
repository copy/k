i:.'0:"i/20"
f:{
 n:i@y
 o:x[y]
 p:(-1+#x)!o+n
 $[p>o;x[x?1+o+!p-o]-:1;x[x?p+!o-p]+:1]
 x[y]:p
 x}
r:i@<(!#i)f/!#i
+/r(#i)!(r?0)+1000*1 2 3
i*:811589153
r:i@<(!#i)f/,/10#,!#i
+/r(#i)!(r?0)+1000*1 2 3
